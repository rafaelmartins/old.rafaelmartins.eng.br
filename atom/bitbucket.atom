<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title type="text">Rafael Martins » bitbucket</title>
  <id>/atom/bitbucket.atom</id>
  <updated>2012-08-13T02:35:34Z</updated>
  <link href="http://old.rafaelmartins.eng.br/" />
  <link href="http://old.rafaelmartins.eng.br/atom/bitbucket.atom" rel="self" />
  <author>
    <name>Rafael G. Martins</name>
  </author>
  <subtitle type="text">Gentoo Linux, Engineering and random stuff.</subtitle>
  <generator>blohg</generator>
  <entry>
    <title type="text">Deploying blohg to bitbucket</title>
    <id>/post/deploying-blohg-to-bitbucket/</id>
    <updated>2012-08-13T02:35:34Z</updated>
    <published>2012-08-13T02:35:34Z</published>
    <link href="http://old.rafaelmartins.eng.br/post/deploying-blohg-to-bitbucket/" />
    <author>
      <name>Rafael G. Martins</name>
      <email>rafael@rafaelmartins.eng.br</email>
    </author>
    <summary type="html">&lt;!-- tags: en-us,blohg,bitbucket,mercurial --&gt;
&lt;p&gt;&lt;a class=&quot;reference external&quot; href=&quot;http://bitbucket.org/&quot;&gt;Bitbucket&lt;/a&gt; is a repository hosting service widely used by &lt;a class=&quot;reference external&quot; href=&quot;http://mercurial.selenic.com/&quot;&gt;Mercurial&lt;/a&gt; users.
Its basic plan is free and includes unlimited private repositories.&lt;/p&gt;
&lt;p&gt;Some people don't know, because it isn't widely advertised, but &lt;a class=&quot;reference external&quot; href=&quot;http://bitbucket.org/&quot;&gt;Bitbucket&lt;/a&gt;
provides free web hosting for static files. Any files stored in a repo called
&lt;tt class=&quot;docutils literal&quot;&gt;username.bitbucket.org&lt;/tt&gt; will be served from &lt;a class=&quot;reference external&quot; href=&quot;http://username.bitbucket.org/&quot;&gt;http://username.bitbucket.org/&lt;/a&gt;.
It just works for user names, as far as I know.&lt;/p&gt;
</summary>
    <content type="html">&lt;!-- tags: en-us,blohg,bitbucket,mercurial --&gt;
&lt;p&gt;&lt;a class=&quot;reference external&quot; href=&quot;http://bitbucket.org/&quot;&gt;Bitbucket&lt;/a&gt; is a repository hosting service widely used by &lt;a class=&quot;reference external&quot; href=&quot;http://mercurial.selenic.com/&quot;&gt;Mercurial&lt;/a&gt; users.
Its basic plan is free and includes unlimited private repositories.&lt;/p&gt;
&lt;p&gt;Some people don't know, because it isn't widely advertised, but &lt;a class=&quot;reference external&quot; href=&quot;http://bitbucket.org/&quot;&gt;Bitbucket&lt;/a&gt;
provides free web hosting for static files. Any files stored in a repo called
&lt;tt class=&quot;docutils literal&quot;&gt;username.bitbucket.org&lt;/tt&gt; will be served from &lt;a class=&quot;reference external&quot; href=&quot;http://username.bitbucket.org/&quot;&gt;http://username.bitbucket.org/&lt;/a&gt;.
It just works for user names, as far as I know.&lt;/p&gt;
&lt;!-- read_more --&gt;
&lt;p&gt;Some documentation is available here:&lt;/p&gt;
&lt;p&gt;&lt;a class=&quot;reference external&quot; href=&quot;https://confluence.atlassian.com/display/BITBUCKET/Publishing+a+Website+on+bitbucket&quot;&gt;https://confluence.atlassian.com/display/BITBUCKET/Publishing+a+Website+on+bitbucket&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;I never cared about creating a way to build a static version of a blohg-based
blog, but blohg is open-source and someone else cared about it. :)&lt;/p&gt;
&lt;p&gt;Benoît Allard implemented a &lt;tt class=&quot;docutils literal&quot;&gt;freeze&lt;/tt&gt; command for blohg, that uses the
&lt;a class=&quot;reference external&quot; href=&quot;http://packages.python.org/Frozen-Flask/&quot;&gt;Frozen-Flask&lt;/a&gt; extension to create a static version of the blog, and it was
merged with blohg a long time ago.&lt;/p&gt;
&lt;p&gt;I will list here the basic steps required to get your blohg-based blog
running on &lt;a class=&quot;reference external&quot; href=&quot;http://bitbucket.org/&quot;&gt;Bitbucket&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&quot;section&quot; id=&quot;creating-the-bitbucket-repository&quot;&gt;
&lt;h4&gt;Creating the Bitbucket repository&lt;/h4&gt;
&lt;p&gt;First of all, create a repository using the Bitbucket web interface.
It should be named &lt;tt class=&quot;docutils literal&quot;&gt;username.bitbucket.org&lt;/tt&gt;. For example, if your username
is &lt;tt class=&quot;docutils literal&quot;&gt;john&lt;/tt&gt;, your repository will be &lt;tt class=&quot;docutils literal&quot;&gt;john.bitbucket.org&lt;/tt&gt;. I'll use &lt;tt class=&quot;docutils literal&quot;&gt;blohg&lt;/tt&gt;
as the username for this example.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;setting-up-your-blohg-repository-before-freeze-the-content&quot;&gt;
&lt;h4&gt;Setting up your blohg repository before &amp;quot;freeze&amp;quot; the content&lt;/h4&gt;
&lt;p&gt;Supposing that you already have a blohg repository with the sources of your
blog, created following the &lt;a class=&quot;reference external&quot; href=&quot;http://docs.blohg.org&quot;&gt;official documentation&lt;/a&gt;,
you should add the following content to your &lt;tt class=&quot;docutils literal&quot;&gt;.hgignore&lt;/tt&gt; file, if it wasn't
added yet by the default blohg template:&lt;/p&gt;
&lt;pre class=&quot;literal-block&quot;&gt;
^build/
&lt;/pre&gt;
&lt;p&gt;This will prevent your blohg repository of include the build files by mistake.&lt;/p&gt;
&lt;p&gt;Now commit the &lt;tt class=&quot;docutils literal&quot;&gt;.hgignore&lt;/tt&gt; file to the repository, if needed:&lt;/p&gt;
&lt;pre class=&quot;literal-block&quot;&gt;
$ hg commit -Am 'Added .hgignore'
&lt;/pre&gt;
&lt;p&gt;These two steps aren't needed if your blohg repository was created using the
template shipped with a recent enough version of blohg.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;creating-a-makefile-to-automate-the-deployment&quot;&gt;
&lt;h4&gt;Creating a Makefile to automate the deployment&lt;/h4&gt;
&lt;p&gt;Now create a &lt;tt class=&quot;docutils literal&quot;&gt;Makefile&lt;/tt&gt; file at the root of your blohg repository, with the
following content (make sure to change &lt;tt class=&quot;docutils literal&quot;&gt;blohg&lt;/tt&gt; to your username):&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nf&quot;&gt;.PHONY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;push&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;USERNAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;blohg
&lt;span class=&quot;nv&quot;&gt;REPO&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;USERNAME&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;.bitbucket.org

&lt;span class=&quot;nf&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
    blohg freeze
    hg clone ssh://hg@bitbucket.org/&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;USERNAME&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;/&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;REPO&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;/ /tmp/&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;REPO&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
    cp -vr build/* /tmp/&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;REPO&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;/
    hg commit -Am &lt;span class=&quot;s2&quot;&gt;&amp;quot;blohg update: $(shell date)&amp;quot;&lt;/span&gt; -R /tmp/&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;REPO&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
    hg push -R /tmp/&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;REPO&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
    rm -rf /tmp/&lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;REPO&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This &lt;tt class=&quot;docutils literal&quot;&gt;Makefile&lt;/tt&gt; isn't optimal, as it will clone/delete a local copy of the
repository each time you deploy your blog, but I think that you got the idea
and can improve it by yourself. :)&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;commiting-the-makefile-to-your-blohg-repository&quot;&gt;
&lt;h4&gt;Commiting the Makefile to your blohg repository&lt;/h4&gt;
&lt;p&gt;You can add this &lt;tt class=&quot;docutils literal&quot;&gt;Makefile&lt;/tt&gt; to your blohg repository, to make the deployments
easier everywhere:&lt;/p&gt;
&lt;pre class=&quot;literal-block&quot;&gt;
$ hg commit -Am 'Added Makefile'
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&quot;section&quot; id=&quot;publishing-the-blog&quot;&gt;
&lt;h4&gt;Publishing the blog&lt;/h4&gt;
&lt;p&gt;If everything is ok you should be able to publish your blog running the
following command:&lt;/p&gt;
&lt;pre class=&quot;literal-block&quot;&gt;
$ make push
&lt;/pre&gt;
&lt;p&gt;If you was already using the repository, you may get some conflicts. You'll
need to fix them by yourself, like you usually do for your software projects
versioned with &lt;a class=&quot;reference external&quot; href=&quot;http://mercurial.selenic.com/&quot;&gt;Mercurial&lt;/a&gt;. :)&lt;/p&gt;
&lt;p&gt;You should run this command each time you publish a new post, change some
configuration parameter, etc. Make sure to run it after commit the changes
to the blohg repository.&lt;/p&gt;
&lt;p&gt;That's it, have fun!&lt;/p&gt;
&lt;/div&gt;
</content>
  </entry>
</feed>
