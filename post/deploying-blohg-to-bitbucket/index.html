<!DOCTYPE html>
<html lang="en-US">
    <head>
        <title>Rafael Martins » Post: Deploying blohg to bitbucket</title>
        <meta charset="utf-8" />
        <meta name="generator" content="blohg 0.13+/e8d8e6d" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link type="text/css" rel="stylesheet" href="/static/bootstrap/css/bootstrap.min.css" />
        <link type="text/css" rel="stylesheet" href="/static/custom.css" />
        <link type="text/css" rel="stylesheet" href="/static/pygments.css" />
        <!--[if lt IE 9]>
        <script src="/static/bootstrap/js/html5shiv.js"></script>
        <script src="/static/bootstrap/js/respond.min.js"></script>
        <![endif]-->
        <link rel="alternate" type="application/atom+xml" href="/atom.atom" title="Rafael Martins" />

<!-- begin opengraph header -->

<meta prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#" />
<meta property="og:site_name" content="Rafael Martins" />
<meta property="og:url" content="http://old.rafaelmartins.eng.br/post/deploying-blohg-to-bitbucket/" />
<meta property="og:title" content="Rafael Martins » Post: Deploying blohg to bitbucket" />
<meta property="og:description" content="Bitbucket is a repository hosting service widely used by Mercurial users. Its basic plan is free and includes unlimited private repositories." />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2012-08-13T02:35:34Z" />
<meta property="article:modified_time" content="2012-08-13T02:40:03Z" />
<meta property="article:tag" content="en-us" />
<meta property="article:tag" content="blohg" />
<meta property="article:tag" content="bitbucket" />
<meta property="article:tag" content="mercurial" />

<!-- end opengraph header -->

<!-- begin disqus header -->

<script type="text/javascript">
    var disqus_shortname = "rafaelmartins-en";
    var disqus_url = "http://old.rafaelmartins.eng.br/post/deploying-blohg-to-bitbucket/";
</script>

<!-- end disqus header -->

    </head>
    <body>
        <div class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand" href="/">Rafael Martins</a>
                    <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                </div>
                <div class="navbar-collapse collapse" id="navbar-main">
                    <ul class="nav navbar-nav">
                        <li><a href="/posts/">Blog</a></li>
                        <li><a href="/about/">About</a></li>
                        <li><a href="/projects/">Projects</a></li>
                        <li><a href="/talks/">Talks</a></li>
                        <li><a href="/guitar-rig/">Guitar Rig</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-md-9">

<!-- begin content -->

<article>
    <h3><a href="/post/deploying-blohg-to-bitbucket/">Deploying blohg to bitbucket</a></h3>

<!-- begin html parsed by docutils -->

<!-- tags: en-us,blohg,bitbucket,mercurial -->
<p><a class="reference external" href="http://bitbucket.org/">Bitbucket</a> is a repository hosting service widely used by <a class="reference external" href="http://mercurial.selenic.com/">Mercurial</a> users.
Its basic plan is free and includes unlimited private repositories.</p>
<p>Some people don't know, because it isn't widely advertised, but <a class="reference external" href="http://bitbucket.org/">Bitbucket</a>
provides free web hosting for static files. Any files stored in a repo called
<tt class="docutils literal">username.bitbucket.org</tt> will be served from <a class="reference external" href="http://username.bitbucket.org/">http://username.bitbucket.org/</a>.
It just works for user names, as far as I know.</p>
<!-- read_more -->
<p>Some documentation is available here:</p>
<p><a class="reference external" href="https://confluence.atlassian.com/display/BITBUCKET/Publishing+a+Website+on+bitbucket">https://confluence.atlassian.com/display/BITBUCKET/Publishing+a+Website+on+bitbucket</a></p>
<p>I never cared about creating a way to build a static version of a blohg-based
blog, but blohg is open-source and someone else cared about it. :)</p>
<p>Benoît Allard implemented a <tt class="docutils literal">freeze</tt> command for blohg, that uses the
<a class="reference external" href="http://packages.python.org/Frozen-Flask/">Frozen-Flask</a> extension to create a static version of the blog, and it was
merged with blohg a long time ago.</p>
<p>I will list here the basic steps required to get your blohg-based blog
running on <a class="reference external" href="http://bitbucket.org/">Bitbucket</a>.</p>
<div class="section" id="creating-the-bitbucket-repository">
<h4>Creating the Bitbucket repository</h4>
<p>First of all, create a repository using the Bitbucket web interface.
It should be named <tt class="docutils literal">username.bitbucket.org</tt>. For example, if your username
is <tt class="docutils literal">john</tt>, your repository will be <tt class="docutils literal">john.bitbucket.org</tt>. I'll use <tt class="docutils literal">blohg</tt>
as the username for this example.</p>
</div>
<div class="section" id="setting-up-your-blohg-repository-before-freeze-the-content">
<h4>Setting up your blohg repository before &quot;freeze&quot; the content</h4>
<p>Supposing that you already have a blohg repository with the sources of your
blog, created following the <a class="reference external" href="http://docs.blohg.org">official documentation</a>,
you should add the following content to your <tt class="docutils literal">.hgignore</tt> file, if it wasn't
added yet by the default blohg template:</p>
<pre class="literal-block">
^build/
</pre>
<p>This will prevent your blohg repository of include the build files by mistake.</p>
<p>Now commit the <tt class="docutils literal">.hgignore</tt> file to the repository, if needed:</p>
<pre class="literal-block">
$ hg commit -Am 'Added .hgignore'
</pre>
<p>These two steps aren't needed if your blohg repository was created using the
template shipped with a recent enough version of blohg.</p>
</div>
<div class="section" id="creating-a-makefile-to-automate-the-deployment">
<h4>Creating a Makefile to automate the deployment</h4>
<p>Now create a <tt class="docutils literal">Makefile</tt> file at the root of your blohg repository, with the
following content (make sure to change <tt class="docutils literal">blohg</tt> to your username):</p>
<div class="highlight"><pre><span class="nf">.PHONY</span><span class="o">:</span> <span class="n">push</span>

<span class="nv">USERNAME</span><span class="o">=</span>blohg
<span class="nv">REPO</span><span class="o">=</span><span class="k">$(</span>USERNAME<span class="k">)</span>.bitbucket.org

<span class="nf">push</span><span class="o">:</span>
    blohg freeze
    hg clone ssh://hg@bitbucket.org/<span class="k">$(</span>USERNAME<span class="k">)</span>/<span class="k">$(</span>REPO<span class="k">)</span>/ /tmp/<span class="k">$(</span>REPO<span class="k">)</span>
    cp -vr build/* /tmp/<span class="k">$(</span>REPO<span class="k">)</span>/
    hg commit -Am <span class="s2">&quot;blohg update: $(shell date)&quot;</span> -R /tmp/<span class="k">$(</span>REPO<span class="k">)</span>
    hg push -R /tmp/<span class="k">$(</span>REPO<span class="k">)</span>
    rm -rf /tmp/<span class="k">$(</span>REPO<span class="k">)</span>
</pre></div>
<p>This <tt class="docutils literal">Makefile</tt> isn't optimal, as it will clone/delete a local copy of the
repository each time you deploy your blog, but I think that you got the idea
and can improve it by yourself. :)</p>
</div>
<div class="section" id="commiting-the-makefile-to-your-blohg-repository">
<h4>Commiting the Makefile to your blohg repository</h4>
<p>You can add this <tt class="docutils literal">Makefile</tt> to your blohg repository, to make the deployments
easier everywhere:</p>
<pre class="literal-block">
$ hg commit -Am 'Added Makefile'
</pre>
</div>
<div class="section" id="publishing-the-blog">
<h4>Publishing the blog</h4>
<p>If everything is ok you should be able to publish your blog running the
following command:</p>
<pre class="literal-block">
$ make push
</pre>
<p>If you was already using the repository, you may get some conflicts. You'll
need to fix them by yourself, like you usually do for your software projects
versioned with <a class="reference external" href="http://mercurial.selenic.com/">Mercurial</a>. :)</p>
<p>You should run this command each time you publish a new post, change some
configuration parameter, etc. Make sure to run it after commit the changes
to the blohg repository.</p>
<p>That's it, have fun!</p>
</div>



<!-- end html parsed by docutils -->

    <div class="clear"></div>
    <div class="metadata well well-sm">
        <p><span class="label label-default"><a href="/tag/en-us/"><i class="glyphicon glyphicon-tag"></i> en-us</a></span> <span class="label label-default"><a href="/tag/blohg/"><i class="glyphicon glyphicon-tag"></i> blohg</a></span> <span class="label label-default"><a href="/tag/bitbucket/"><i class="glyphicon glyphicon-tag"></i> bitbucket</a></span> <span class="label label-default"><a href="/tag/mercurial/"><i class="glyphicon glyphicon-tag"></i> mercurial</a></span> </p>
        Author: <a href="mailto:rafael@rafaelmartins.eng.br">Rafael G. Martins</a>
        <br />
        Published on: Aug 13, 2012, 2:35:34 AM - Modified on: Aug 13, 2012, 2:40:03 AM
        <br />
        <a href="/post/deploying-blohg-to-bitbucket/">Permalink</a> - <a href="/source/post/deploying-blohg-to-bitbucket.txt">Source code</a> - <a href="/post/deploying-blohg-to-bitbucket/#disqus_thread">Comments</a>
    </div>

<!-- start disqus post -->

<div id="disqus_thread"></div>
<script type="text/javascript">
    (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = 'http://rafaelmartins-en.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>
    Please enable JavaScript to view the
    <a href="http://disqus.com/?ref_noscript=rafaelmartins-en">
        comments powered by Disqus.
    </a>
</noscript>
<a href="http://disqus.com" class="dsq-brlink">
    blog comments powered by <span class="logo-disqus">Disqus</span>
</a>

<!-- end disqus post -->



<!-- start pagination -->


<!-- end pagination -->

<!-- end content -->

                </div>
                <div class="col-md-3 sidebar">
                    <div class="panel panel-default hidden-xs">
                        <div class="panel-heading">
                            <h4 class="panel-title">Blog Tags</h4>
                        </div>
                        <div class="panel-body tagcloud">
                            <span class="label label-default"><a href="/tag/bitbucket/"><i class="glyphicon glyphicon-tag"></i> bitbucket</a></span>
                            <span class="label label-default"><a href="/tag/blohg/"><i class="glyphicon glyphicon-tag"></i> blohg</a></span>
                            <span class="label label-default"><a href="/tag/celtic-folk/"><i class="glyphicon glyphicon-tag"></i> celtic-folk</a></span>
                            <span class="label label-default"><a href="/tag/collabora/"><i class="glyphicon glyphicon-tag"></i> collabora</a></span>
                            <span class="label label-default"><a href="/tag/diffball/"><i class="glyphicon glyphicon-tag"></i> diffball</a></span>
                            <span class="label label-default"><a href="/tag/electronics/"><i class="glyphicon glyphicon-tag"></i> electronics</a></span>
                            <span class="label label-default"><a href="/tag/en-us/"><i class="glyphicon glyphicon-tag"></i> en-us</a></span>
                            <span class="label label-default"><a href="/tag/engineering/"><i class="glyphicon glyphicon-tag"></i> engineering</a></span>
                            <span class="label label-default"><a href="/tag/events/"><i class="glyphicon glyphicon-tag"></i> events</a></span>
                            <span class="label label-default"><a href="/tag/fisl/"><i class="glyphicon glyphicon-tag"></i> fisl</a></span>
                            <span class="label label-default"><a href="/tag/g-octave/"><i class="glyphicon glyphicon-tag"></i> g-octave</a></span>
                            <span class="label label-default"><a href="/tag/gentoo/"><i class="glyphicon glyphicon-tag"></i> gentoo</a></span>
                            <span class="label label-default"><a href="/tag/git/"><i class="glyphicon glyphicon-tag"></i> git</a></span>
                            <span class="label label-default"><a href="/tag/google/"><i class="glyphicon glyphicon-tag"></i> google</a></span>
                            <span class="label label-default"><a href="/tag/gsoc/"><i class="glyphicon glyphicon-tag"></i> gsoc</a></span>
                            <span class="label label-default"><a href="/tag/lua/"><i class="glyphicon glyphicon-tag"></i> lua</a></span>
                            <span class="label label-default"><a href="/tag/mercurial/"><i class="glyphicon glyphicon-tag"></i> mercurial</a></span>
                            <span class="label label-default"><a href="/tag/music/"><i class="glyphicon glyphicon-tag"></i> music</a></span>
                            <span class="label label-default"><a href="/tag/oembed/"><i class="glyphicon glyphicon-tag"></i> oembed</a></span>
                            <span class="label label-default"><a href="/tag/pic/"><i class="glyphicon glyphicon-tag"></i> pic</a></span>
                            <span class="label label-default"><a href="/tag/pt-br/"><i class="glyphicon glyphicon-tag"></i> pt-br</a></span>
                            <span class="label label-default"><a href="/tag/pyoembed/"><i class="glyphicon glyphicon-tag"></i> pyoembed</a></span>
                            <span class="label label-default"><a href="/tag/python/"><i class="glyphicon glyphicon-tag"></i> python</a></span>
                            <span class="label label-default"><a href="/tag/random-stuff/"><i class="glyphicon glyphicon-tag"></i> random-stuff</a></span>
                            <span class="label label-default"><a href="/tag/scottish-folk/"><i class="glyphicon glyphicon-tag"></i> scottish-folk</a></span>
                            <span class="label label-default"><a href="/tag/stupid-stuff/"><i class="glyphicon glyphicon-tag"></i> stupid-stuff</a></span>
                        </div>
                    </div>
                    <div class="panel panel-default hidden-xs">
                        <div class="panel-heading">
                            <h4 class="panel-title">Under the hood</h4>
                        </div>
                        <div class="list-group">
                            <a class="list-group-item" href="http://blohg.org/">blohg</a>
                            <a class="list-group-item" href="http://git-scm.com/">Git</a>
                            <a class="list-group-item" href="http://www.gentoo.org/">Gentoo Linux</a>
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">Content License</h4>
                        </div>
                        <div class="panel-body">
                            <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">
                                <img alt="Creative Commons License" class="license"
                                    src="/static/creative-commons-88x31.png" />
                            </a>
                            This work is licensed under a <a rel="license"
                                href="http://creativecommons.org/licenses/by-nc/4.0/">
                                Creative Commons Attribution-NonCommercial 4.0 International License</a>.
                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">Disclaimer</h4>
                        </div>
                        <div class="panel-body">
                            This is a personal weblog. The opinions expressed here represent my own
                            and not those of my employer, Gentoo Foundation or anyone else.
                        </div>
                    </div>
                </div>
            </div>
            <footer>
                <div class="row">
                    <div class="col-md-12">
                        <p>
                            Powered by: <a href="http://blohg.org/">blohg 0.13+/e8d8e6d</a>
                        </p>
                    </div>
                </div>
            </footer>
        </div>
        <script src="/static/bootstrap/js/jquery.min.js"></script>
        <script src="/static/bootstrap/js/bootstrap.min.js"></script>
        <script src="/static/resize.js"></script>

<!-- begin disqus footer -->

<script type="text/javascript">
    //<![CDATA[
    (function() {
        var links = document.getElementsByTagName('a');
        var query = '?';
        for(var i = 0; i < links.length; i++) {
            if(links[i].href.indexOf('#disqus_thread') >= 0) {
                query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
            }
        }
        document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/rafaelmartins-en/get_num_replies.js' + query + '"></' + 'script>');
    })();
    //]]>
</script>

<!-- end disqus footer -->

<!-- begin google analytics -->

<script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
    var pageTracker = _gat._getTracker("UA-2886928-8");
    pageTracker._initData();
    pageTracker._trackPageview();
</script>

<!-- end google analytics -->

    </body>
</html>