{%- extends 'base.html' %}

{%- block title %}{% if title %} Â» {{ title }}{% endif %}{% endblock %}

{%- block body %}
{%- if tag -%}
    <h2 class="mainheading">Tag: {{ ' + '.join(tag) }} (<small><a href="{{
        url_for('views.atom', tag='/'.join(tag)) }}">Atom feed</a></small>)</h2>
{%- endif %}

{%- for post in posts %}
<article class="post">
    <header>
        <h2>{% if is_post(post.slug) %}<a href="{{
            url_for('views.content', slug=post.slug) }}">{{ post.title }}</a>{%
            else %}{{ post.title }}{%- endif %}</h2>
        <p class="postinfo">
            Published on <time>{{ post.datetime|dateformat }}</time>
            {%- if post.tags %}
            under
            {%- for tag in post.tags %}
                <a href="{{ url_for('views.tag', tag=tag) }}">{{ tag }}</a>
                {%- if not loop.last %}, {% endif %}
            {%- endfor %}
            {%- endif %}.
            {% if post.mdatetime -%}
            Modified on <time>{{ post.mdatetime|dateformat }}</time>.
            {%- endif %}
            
        </p>
    </header>

<!-- begin html parsed by docutils -->

{% if full_content %}{{ post.full_html|safe }}{% else %}{{
    post.abstract_html|safe }}{%- endif %}
<!-- end html parsed by docutils -->

{% if post.read_more and not full_content -%}
<p><a href="{{ url_for('views.content', slug=post.slug) }}">Read more...</a></p>
{% endif -%}
    <footer>
        <!--<span class="author">Authorname</span>-->
        <span class="permalink">
            <a href="{{ url_for('views.content', slug=post.slug) }}">
                Permalink
            </a>
        </span>
        <span class="permalink">
            <a href="{{ url_for('views.source', slug=post.slug) }}">
                Source code
            </a>
        </span>
        {% if is_post(post.slug) and config.DISQUS -%}
        <span class="comments">
            <a href="{{ url_for('views.content', slug=post.slug) }}#disqus_thread">
                Comments
            </a>
        </span>
        {%- endif %}
    </footer>
</article>

<!-- start disqus post -->
{% block disqus_post %}{% endblock %}

<!-- end disqus post -->
{% endfor %}

<!-- start pagination -->
{% if pagination %}
<div class="wp-pagenavi">
    {%- if pagination.current != 1 %}
    <a href="{{ url_for('views.home', page=1) }}" title="&lt;&lt; First">
        &lt;&lt; First
    </a>
    {%- else %}
    <span>&lt;&lt; First</span>
    {%- endif %}
    {%- if pagination.current > 1 %}
    <a href="{{ url_for('views.home', page=pagination.current-1) }}" title="&lt; Previous">
         &lt; Previous
    </a>
    {%- else %}
    <span>&lt; Previous</span>
    {%- endif %}
    <span class="extend">...</span>
    {%- for i in range(1, pagination.num_pages + 1) %}
    {%- if pagination.current != i %}
    <a href="{{ url_for('views.home', page=i) }}" title="{{ i }}">
        {{ i }}
    </a>
    {%- else %}
    <span class="current">{{ i }}</span>
    {%- endif %}
    {%- endfor %}
    <span class="extend">...</span>
    {%- if pagination.current < pagination.num_pages %}
    <a href="{{ url_for('views.home', page=pagination.current+1) }}" title="Next &gt;">Next &gt;</a>
    {%- else %}
    <span>Next &gt;</span>
    {%- endif %}
    {%- if pagination.current != pagination.num_pages %}
    <a href="{{ url_for('views.home', page=pagination.num_pages) }}" title="Last &gt;&gt;">Last &gt;&gt;</a>
    {%- else %}
    <span>Last &gt;&gt;</span>
    {%- endif %}
</div>
{%- endif %}

<!-- end pagination -->

{% endblock %}
